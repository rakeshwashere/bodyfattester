<html>

<head>
  <title> dashboard </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://www.gstatic.com/firebasejs/3.7.3/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyB84XxilPHdBI5JhZmG9s02gfoBtdYqk5w",
      authDomain: "bodyfatcal-747ad.firebaseapp.com",
      databaseURL: "https://bodyfatcal-747ad.firebaseio.com",
      storageBucket: "bodyfatcal-747ad.appspot.com",
      messagingSenderId: "390686966560"
    };
    var app = firebase.initializeApp(config);
    var provider = new firebase.auth.GoogleAuthProvider();
    provider.addScope('https://www.googleapis.com/auth/plus.login');
  </script>
</head>
<style>
  label {
    font-weight: lighter;
  }
</style>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"></link>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-database.js"></script>

<script>
    var db = app.database();
    var userID
    db.ref('sample').set({
      key: "value"
    });

    if (!app.auth().currentUser) {

    }

    function calCatFromBMI(bmi, gender) {
      var cat = ""
      if (gender == "female") {
        if (bmi < 17.5)
          cat = "Anorexia"
        else if (bmi < 19.1)
          cat = "Underweight"
        else if (bmi > 19.1 && bmi <= 25.8)
          cat = "In normal range"
        else if (bmi > 25.8 && bmi <= 27.3)
          cat = "Marginally overweight"
        else if (bmi > 27.3 && bmi <= 32.3)
          cat = "Overweight"
        else if (bmi > 32.3 && bmi <= 35)
          cat = "Obese"
        else if (bmi > 35 && bmi <= 40)
          cat = "Severely obese"
        else if (bmi > 40 && bmi <= 50)
          cat = "Morbidly obese"
        else if (bmi > 50)
          cat = "Super obese"
      } else if (gender == "male") {
        if (bmi <= 17.5)
          cat = "Anorexia"
        else if (bmi <= 20.7)
          cat = "Underweight"
        else if (bmi > 20.7 && bmi <= 26.4)
          cat = "In normal range"
        else if (bmi > 26.4 && bmi <= 27.8)
          cat = "Marginally overweight"
        else if (bmi > 27.8 && bmi <= 31.1)
          cat = "Overweight"
        else if (bmi > 31.1 && bmi <= 35)
          cat = "Obese"
        else if (bmi > 35 && bmi <= 40)
          cat = "Severely obese"
        else if (bmi > 40 && bmi <= 50)
          cat = "Morbidly obese"
        else if (bmi > 50)
          cat = "Super obese"
      }

      return cat
    }

    $(document).ready(function () {

      app.auth().onAuthStateChanged(function (user) {
        if (user) {
          userID = user.uid;
          var email = user.email ? user.email : ""
          // console.log(JSON.stringify(user))
          $("body").css('visibility', 'visible');
          $(".navbar-right").prepend($(`<li><a hreaf="# "><span class="glyphicon "></span>${email}</a></li>`))
        } else {

          var segs = window.location.pathname.split('/')
          segs[segs.length - 1] = 'index.html'
          window.location = segs.join('/');

        }
      });

      $("#logout").click(function (event) {
        event.preventDefault();
        app.auth().signOut().then(function () {
          var segs = window.location.pathname.split('/')
          segs[segs.length - 1] = 'index.html'
          window.location = segs.join('/');

        }).catch(function (error) {
          alert("signout not successfull ")
        });
      });

      $("#cal1").submit(function (event) {
        event.preventDefault();

        // var heightInInches = ($("#cal1 feet").val() * 12 + $("cal1 inches").val());


        $("#cal1 bmi").val(bmi)

        var bmiRef = db.ref('users/' + userID + '/bmi').push();
        var bmiObj = {}
        var formData = $("#cal1").serializeArray().map(function (obj) {
          bmiObj[obj.name] = obj.value;
        });

        console.log(JSON.stringify(bmiObj, null, 2))
        var heightInInches = (Number(bmiObj.feet) * 12) + Number(bmiObj.inches);
        var bmi = (Number(bmiObj.weight) / (heightInInches * heightInInches)) * 703
        var bmr
        var cat = ""


        bmiObj.gender = $('input:radio[name=gender]:checked').val();

        if (bmiObj.gender == "female") {
          bmr = 655 + (4.35 * Number(bmiObj.weight) + (4.7 * bmiObj.inches) - (4.7 * Number(bmiObj.age)))
        } else if (bmiObj.gender == "male") {
          bmr = 66 + (6.23 * Number(bmiObj.weight) + (12.7 * bmiObj.inches) - (6.8 * Number(bmiObj.age)))
        }

        bmi = bmi ? bmi.toFixed(2) : ""
        $("#cal1 [name=bmi]").val(bmi);
        bmiObj.bmi = bmi;

        cat = calCatFromBMI(bmi, bmiObj.gender)

        $("#cal1 #category").hide()
        $("#cal1 #category").text(cat)
        $("#cal1 #category").fadeIn("slow")
        bmiObj.category = cat


        bmr = bmr ? bmr.toFixed(2) : ""
        $("#cal1 [name=bmr]").val(bmr);
        bmiObj.bmr = bmr;

        bmiObj.method = "BMI/BMR";

        bmiRef.set(bmiObj);
      });

      $("#cal1-clear").click(function (event) {
        $(this).closest('form').find("input[type=number]").val("");
        $("#category").text("");
      })
    });

</script>


<body style="visibility: hidden">

  <nav class=" navbar navbar-inverse ">
    <div class="container-fluid ">
      <div class="navbar-header ">
        <a class="navbar-brand " href="# ">Body Fat</a>
      </div>
      <ul class="nav navbar-nav ">
        <li class="active "><a href="# ">Home</a></li>
        <li class="dropdown "><a class="dropdown-toggle " data-toggle="dropdown " href="# ">Page 1 <span class="caret "></span></a>
          <ul class="dropdown-menu ">
            <li><a href="# ">Page 1-1</a></li>
            <li><a href="# ">Page 1-2</a></li>
            <li><a href="# ">Page 1-3</a></li>
          </ul>
        </li>
        <li><a href="# ">Page 2</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!--<li><a href="# "><span class="glyphicon glyphicon-user "></span> Sign Up</a></li>-->
        <li><a hreaf="# " id="logout"><span class="glyphicon glyphicon-log-out "></span>Log out</a></li>
      </ul>
    </div>
  </nav>

  <div class="container ">
    <!--<h3>Right Aligned Navbar</h3>-->
    <!--<p>The .navbar-right class is used to right-align navigation bar buttons.</p>-->
    <div class="row col-md-12">
      <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#tab1">Home</a></li>
        <li><a data-toggle="tab" href="#menu1">Menu 1</a></li>
        <li><a data-toggle="tab" href="#menu2">Menu 2</a></li>
        <li><a data-toggle="tab" href="#menu3">Menu 3</a></li>
      </ul>

      <div class="tab-content">
        <div id="tab1" class="tab-pane fade in active">
          <!--<h3>HOME</h3>-->
          <form id="cal1" class="form-inline">
            <div> &nbsp</div>

            <div class="row">
              <label class="col-sm-2 col-form-label col-form-label-lg">Your Height:</label>

              <input type="number" name="feet" step="any" class="form-control " required d="feet" placeholder="Feet" value="5">
              <label>feet </label>
              <input type="number" name="inches" step="any" class="form-control mb-2 mr-sm-2 mb-sm-0" required id="inches" placeholder="Inches"
                value="10">
              <label>inches  </label>

            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg"> Weight:</label>
              <input type="number" name="weight" step="any" class="form-control" required id="weight" placeholder="Your Weight" value="170">
              <label>Pounds</label>
            </div>
            <div> &nbsp</div>

            <div class="row">
              <label class="col-sm-2 col-form-label col-form-label-lg">You are:</label>
              <label class="radio-inline">
                <input type="radio" name="gender" value="female" required>Female
                 </label>
              <label class="radio-inline">
                <input type="radio" name="gender" value="male" required>male
              </label>

            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Your Age:</label>
              <input type="number" step="any" name="age" required class="form-control" id="age" placeholder="Your Age" value="27">
              <label>Years</label>
            </div>

            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Your BMI:</label>
              <input type="number" step="any" name="bmi" class="form-control" id="bmi" placeholder="">
              <!--<label>Years</label>-->
              <span class="label label-default" id="category"></span>
            </div>

            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Your BMR:</label>
              <input type="number" step="any" name="bmr" class="form-control" id="bmr" placeholder="">
              <!--<label>Years</label>-->
            </div>
            <div> &nbsp</div>

            <button id="cal1-button" type="submit" class="btn btn-primary">Calculate</button>
            <button id="cal1-clear" class="btn btn-primary">Clear</button>
          </form>
        </div>
        <div id="menu1" class="tab-pane fade">
          <h3>Navy Tape</h3>
          <form id="cal2" class="form-inline">
            <div> &nbsp</div>

            <div class="row">
              <label class="col-sm-2 col-form-label col-form-label-lg">Your Height:</label>

              <input type="number" name="feet" step="any" class="form-control " required d="feet" placeholder="Feet" value="5">
              <label>feet </label>
              <input type="number" name="inches" step="any" class="form-control mb-2 mr-sm-2 mb-sm-0" required id="inches" placeholder="Inches"
                value="10">
              <label>inches  </label>

            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg"> Weight:</label>
              <input type="number" name="weight" step="any" class="form-control" required id="weight" placeholder="Your Weight" value="170">
              <label>Pounds</label>
            </div>
            <div> &nbsp</div>

            <div class="row">
              <label class="col-sm-2 col-form-label col-form-label-lg">You are:</label>
              <label class="radio-inline">
                <input type="radio" name="gender" value="female" required>Female
                 </label>
              <label class="radio-inline">
                <input type="radio" name="gender" value="male" required>male
              </label>

            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Your Age:</label>
              <input type="number" step="any" name="age" required class="form-control" id="age" placeholder="Your Age" value="27">
              <label>Years</label>
            </div>

            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Waist Circumference:</label>
              <input type="number" step="any" name="waist" class="form-control" id="waist" placeholder="">
              <!--<label>Years</label>-->
              <!--<span class="label label-default" id="category"></span>-->
            </div>

            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Wrist Circumference:</label>
              <input type="number" step="any" name="wrist" class="form-control" id="wrist" placeholder="">
              <!--<label>Years</label>-->
            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Forearm Circumference:</label>
              <input type="number" step="any" name="forearm" class="form-control" id="forearm" placeholder="">
              <!--<label>Years</label>-->
            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Hip Circumference:</label>
              <input type="number" step="any" name="hip" class="form-control" id="hip" placeholder="">
              <!--<label>Years</label>-->
            </div>
            <div> &nbsp</div>
            <div class="row">

              <label class="col-sm-2 col-form-label col-form-label-lg">Body Fat Percentage:</label>
              <input type="number" step="any" name="bodyFat" class="form-control" id="bodyFat" placeholder="">
              <!--<label>Years</label>-->
            </div>
            <div> &nbsp</div>

            <button id="cal1-button" type="submit" class="btn btn-primary">Calculate</button>
            <button id="cal1-clear" class="btn btn-primary">Clear</button>
          </form>
        </div>
        <div id="menu2" class="tab-pane fade">
          <h3>Menu 2</h3>
          <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.</p>
        </div>
        <div id="menu3" class="tab-pane fade">
          <h3>Menu 3</h3>
          <p>Eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
        </div>
      </div>
    </div>
    <!--<div class="pull-right col-md-6"> kko</div>-->
  </div>
</body>

</html>